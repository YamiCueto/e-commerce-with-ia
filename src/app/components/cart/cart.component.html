<div class="cart-container">
  <!-- Header -->
  <div class="header-section">
    <div class="container">
      <h1>Carrito de Compras</h1>
      <p *ngIf="cartItems().length > 0">{{ cartItems().length }} productos en tu carrito</p>
      <p *ngIf="cartItems().length === 0">Tu carrito está vacío</p>
    </div>
  </div>

  <div class="container">
    <!-- Empty Cart -->
    <div class="empty-cart" *ngIf="cartItems().length === 0">
      <mat-icon>shopping_cart</mat-icon>
      <h2>Tu carrito está vacío</h2>
      <p>Agrega algunos productos increíbles a tu carrito</p>
      <button mat-raised-button color="primary" routerLink="/products">
        Explorar productos
      </button>
    </div>

    <!-- Cart Items -->
    <div class="cart-content" *ngIf="cartItems().length > 0">
      <div class="cart-items">
        <mat-card class="cart-item" *ngFor="let item of cartItems()">
          <div class="item-image">
            <img [src]="item.product.image" [alt]="item.product.name ? item.product.name : 'Imagen de producto'" [title]="item.product.name ? item.product.name : 'Producto'">
          </div>

          <div class="item-details">
            <h3>{{ item.product.name }}</h3>
            <p class="item-price">${{ item.product.price }}</p>
          </div>

          <div class="quantity-controls">
            <button mat-mini-fab color="primary" (click)="updateQuantity(item, -1)"
                    [disabled]="item.quantity <= 1">
              <mat-icon>remove</mat-icon>
            </button>
            <span class="quantity">{{ item.quantity }}</span>
            <button mat-mini-fab color="primary" (click)="updateQuantity(item, 1)">
              <mat-icon>add</mat-icon>
            </button>
          </div>

          <div class="item-total">
            <p class="total-price">${{ item.total | number:'1.2-2' }}</p>
          </div>

          <div class="item-actions">
            <button mat-icon-button color="warn" (click)="removeItem(item.product.id)"
                    [attr.aria-label]="'Eliminar ' + item.product.name + ' del carrito'">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </mat-card>
      </div>

      <!-- Cart Summary -->
      <div class="cart-summary">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Resumen del pedido</mat-card-title>
          </mat-card-header>

          <mat-card-content>
            <div class="summary-row">
              <span>Subtotal:</span>
              <span>${{ subtotal | number:'1.2-2' }}</span>
            </div>

            <div class="summary-row">
              <span>Impuestos:</span>
              <span>${{ tax | number:'1.2-2' }}</span>
            </div>

            <div class="summary-row">
              <span>Envío:</span>
              <span *ngIf="shipping > 0">${{ shipping | number:'1.2-2' }}</span>
              <span *ngIf="shipping === 0" class="free-shipping">¡Gratis!</span>
            </div>

            <mat-divider></mat-divider>

            <div class="summary-row total-row">
              <span>Total:</span>
              <span class="total-amount">${{ total | number:'1.2-2' }}</span>
            </div>
          </mat-card-content>

          <mat-card-actions>
            <button mat-raised-button color="accent" class="checkout-btn"
                    (click)="proceedToCheckout()">
              Proceder al pago
            </button>
            <button mat-button color="warn" (click)="clearCart()">
              Vaciar carrito
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>

    <!-- Continue Shopping -->
    <div class="continue-shopping" *ngIf="cartItems().length > 0">
      <button mat-button routerLink="/products">
        <mat-icon>arrow_back</mat-icon>
        Continuar comprando
      </button>
    </div>
  </div>
</div>
